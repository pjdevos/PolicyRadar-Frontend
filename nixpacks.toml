providers = ["node"]

[variables]
  NODE_ENV = "production"
  REACT_APP_API_BASE_URL = "https://policyradar-backend-production.up.railway.app/api"
  REACT_APP_ENVIRONMENT = "production"
  REACT_APP_VERSION = "1.0.0"
  NODE_OPTIONS = "--max-old-space-size=2048"
  NIXPACKS_NODE_VERSION = "22"

[phases.setup]
  nixPkgs = ["nodejs-22_x", "npm-10_x"]

[phases.install]
  cmds = ["npm ci --only=production --no-optional --prefer-offline"]

[phases.build]
  cmds = ["npm run build"]

[start]
  cmd = "npx serve -s build -l $PORT"